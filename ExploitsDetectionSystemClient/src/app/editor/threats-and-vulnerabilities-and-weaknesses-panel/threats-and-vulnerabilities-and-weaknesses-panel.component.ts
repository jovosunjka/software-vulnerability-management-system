import { Component, OnInit, Input } from '@angular/core';
import { ThreatsAndVulnerabilitiesAndWeaknesses } from 'src/app/shared/model/threats-and-vulnerabilities-and-weaknesses';
import { Threat } from 'src/app/shared/model/threat';
import { Vulnerability } from 'src/app/shared/model/vulnerability';
import { Weakness } from 'src/app/shared/model/weakness';

@Component({
  selector: 'app-threats-and-vulnerabilities-and-weaknesses-panel',
  templateUrl: './threats-and-vulnerabilities-and-weaknesses-panel.component.html',
  styleUrls: ['./threats-and-vulnerabilities-and-weaknesses-panel.component.css']
})
export class ThreatsAndVulnerabilitiesAndWeaknessesPanelComponent implements OnInit {
  @Input() threatsAndVulnerabilitiesAndWeaknesses: ThreatsAndVulnerabilitiesAndWeaknesses;

  selectedThreat: Threat;
  selectedThreatIndex: number;

  selectedVulnerability: Vulnerability;
  selectedVulnerabilityIndex: number;

  selectedWeakness: Weakness;
  selectedWeaknessIndex: number;


  constructor() {
  }

  ngOnInit() {
  }

  setSelectedThreatIndex(selectedThreatIndex: number) {
    this.selectedThreatIndex = selectedThreatIndex;
    this.selectedThreat = this.threatsAndVulnerabilitiesAndWeaknesses.threats[selectedThreatIndex];
  }

  setSelectedVulnerabilityIndex(selectedVulnerabilityIndex: number) {
    this.selectedVulnerabilityIndex = selectedVulnerabilityIndex;
    this.selectedVulnerability = this.threatsAndVulnerabilitiesAndWeaknesses.vulnerabilities[selectedVulnerabilityIndex];
  }

  setSelectedWeaknessIndex(selectedWeaknessIndex: number) {
    this.selectedWeaknessIndex = selectedWeaknessIndex;
    this.selectedWeakness = this.threatsAndVulnerabilitiesAndWeaknesses.weaknesses[selectedWeaknessIndex];
  }

  resetThreatAnalysisPanel() {
    this.selectedThreat = undefined;
    this.selectedThreatIndex = undefined;
  }

  resetVulnerabilityAnalysisPanel() {
    this.selectedVulnerability = undefined;
    this.selectedVulnerabilityIndex = undefined;
  }

  resetWeaknessAnalysisPanel() {
    this.selectedWeakness = undefined;
    this.selectedWeaknessIndex = undefined;
  }

}
