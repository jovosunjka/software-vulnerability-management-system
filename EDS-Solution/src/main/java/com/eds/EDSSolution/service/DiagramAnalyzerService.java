package com.eds.EDSSolution.service;


import com.eds.EDSSolution.model.dto.ElementExploitDTO;
import com.eds.EDSSolution.model.dto.ThreatDTO;
import com.eds.EDSSolution.model.dto.ThreatsAndVulnerabilitiesAndWeaknessesDTO;
import com.eds.EDSSolution.model.dto.ThreatsAndVulnerabilitiesDTO;
import org.apache.fop.apps.FOPException;
import org.json.simple.parser.ParseException;
import org.springframework.core.io.InputStreamResource;

import javax.xml.transform.TransformerException;
import java.io.File;
import java.io.IOException;
import java.util.List;

public interface DiagramAnalyzerService {
    List<ElementExploitDTO> startAnalyzer(File diagramFile, File exploits) throws Exception;

    List<ElementExploitDTO> startAnalyzer(String diagramXml) throws Exception;

    ThreatsAndVulnerabilitiesAndWeaknessesDTO/*ThreatsAndVulnerabilitiesDTO*/ analyze(String sourceDiagramXml) throws IOException, ParseException;

    InputStreamResource createReport(String sourceDiagramXml) throws TransformerException,
            IOException, FOPException, ParseException;

    InputStreamResource endAnalyzer(List<ElementExploitDTO> elementExploits, File diagramFile, File exploits) throws TransformerException,
            IOException, FOPException, ParseException;
}
