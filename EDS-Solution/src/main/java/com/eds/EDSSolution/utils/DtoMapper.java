package com.eds.EDSSolution.utils;

import com.eds.EDSSolution.model.dto.VulnerabilityDTO;
import com.eds.EDSSolution.model.report.ReportElementVulnerabilities;
import com.eds.EDSSolution.model.report.ReportVulnerabilities;
import com.eds.EDSSolution.model.risk_pattern.CVEitem;

import java.util.ArrayList;
import java.util.List;

public class DtoMapper {

    public static List<VulnerabilityDTO> prepareVulnerabilityDTOs(ReportVulnerabilities reportVulnerabilities,
                                                                  String diagramName) {
        List<VulnerabilityDTO> vulnerabilityDTOs = new ArrayList<VulnerabilityDTO>();

        for (ReportElementVulnerabilities rev : reportVulnerabilities.getElementVulnerabilities()) {
            for (CVEitem cveItem : rev.getCves().getCve()) {
                vulnerabilityDTOs.add(new VulnerabilityDTO(diagramName, rev.getAffectedElement(), cveItem));
            }
        }

        return vulnerabilityDTOs;
    }

}
