package com.eds.EDSSolution.model.dto;

import com.eds.EDSSolution.EDS_Library.diagram.StringAndLink;

import java.io.Serializable;
import java.util.List;
import java.util.stream.Collectors;

public class ThreatDTO {
    private String id;
    private String diagram;
    private String severity;
    private String title;
    private String description;
    private String countermeasures;
    private String elementOrFlow; // id // diagram pattern: element-flow-element (flow) or element
    private String endangeredAssets;

    public ThreatDTO() {

    }

    public ThreatDTO(String id, String diagram, String severity, String title, StringAndLink description,
                     StringAndLink countermeasures, String elementOrFlow, List<String> endangeredAssets) {
        this.id = id;
        this.diagram = diagram;
        this.severity = severity;
        this.title = title;
        this.description = description.getContent().stream()
                                                    .map(s -> s.toString())
                                                    .collect(Collectors.joining());
        this.countermeasures = countermeasures.getContent().stream()
                .map(s -> s.toString())
                .collect(Collectors.joining());
        this.elementOrFlow = elementOrFlow;
        this.endangeredAssets = String.join(", ", endangeredAssets);
    }

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }

    public String getDiagram() {
        return diagram;
    }

    public void setDiagram(String diagram) {
        this.diagram = diagram;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getCountermeasures() {
        return countermeasures;
    }

    public void setCountermeasures(String countermeasures) {
        this.countermeasures = countermeasures;
    }

    public String getElementOrFlow() {
        return elementOrFlow;
    }

    public void setElementOrFlow(String elementOrFlow) {
        this.elementOrFlow = elementOrFlow;
    }

    public String getEndangeredAssets() {
        return endangeredAssets;
    }

    public void setEndangeredAssets(String endangeredAssets) {
        this.endangeredAssets = endangeredAssets;
    }
}
