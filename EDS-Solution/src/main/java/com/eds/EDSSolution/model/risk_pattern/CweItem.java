package com.eds.EDSSolution.model.risk_pattern;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

public class CweItem {
    private String name;
    private String description;
    private List<PotentialMitigation> potentialMitigations;
    private List<DetectionMethod> detectionMethods;
    private String likelihoodOfExploit;
	private String severity; // treba ga izracunati po formuli
    //  Common Consequences

    // https://cwe.mitre.org/cwss/cwss_v1.0.1.html, sekcija 2.5.3 Likelihood of Exploit (EX)
    private static final Map<String, Float> likelihoodOfExploitMappingOnNumberValues =
                                                                            new HashMap<String, Float>();
    static {
        likelihoodOfExploitMappingOnNumberValues.put("High", 1.0F);
        likelihoodOfExploitMappingOnNumberValues.put("Medium", 0.6F);
        likelihoodOfExploitMappingOnNumberValues.put("Low", 0.2F);
        likelihoodOfExploitMappingOnNumberValues.put("None", 0.0F);
        likelihoodOfExploitMappingOnNumberValues.put("Default", 0.6F);
        likelihoodOfExploitMappingOnNumberValues.put("Unknown", 0.5F);
        likelihoodOfExploitMappingOnNumberValues.put("Not Applicable", 1.0F);
        likelihoodOfExploitMappingOnNumberValues.put("Quantified", 0.0F);
    }

    public CweItem() {}

    public CweItem(String name, String description, List<PotentialMitigation> potentialMitigations, List<DetectionMethod> detectionMethods,
                   String likelihoodOfExploit) {
        this.name = name;
        this.description = description;
        this.potentialMitigations = potentialMitigations;
        this.detectionMethods = detectionMethods;
        this.likelihoodOfExploit = likelihoodOfExploit;
        this.severity = null;
    }

    public CweItem(CweItem cweItem) {
        // shallow copy of attributes
        this.name = cweItem.name;
        this.description = cweItem.description;
        this.potentialMitigations = cweItem.potentialMitigations;
        this.detectionMethods = cweItem.detectionMethods;
        this.likelihoodOfExploit = cweItem.likelihoodOfExploit;
        this.severity = null;
    }

    public float getLikelihoodOfExploitNumberValue() {
        if (likelihoodOfExploit == null) {
            return 0.0F;
        }
        return likelihoodOfExploitMappingOnNumberValues.getOrDefault(likelihoodOfExploit, 0.0F);
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public List<PotentialMitigation> getPotentialMitigations() {
        return potentialMitigations;
    }

    public void setPotentialMitigations(List<PotentialMitigation> potentialMitigations) {
        this.potentialMitigations = potentialMitigations;
    }

    public List<DetectionMethod> getDetectionMethods() {
        return detectionMethods;
    }

    public void setDetectionMethods(List<DetectionMethod> detectionMethods) {
        this.detectionMethods = detectionMethods;
    }

    public String getLikelihoodOfExploit() {
        return likelihoodOfExploit;
    }

    public void setLikelihoodOfExploit(String likelihoodOfExploit) {
        this.likelihoodOfExploit = likelihoodOfExploit;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }
}
