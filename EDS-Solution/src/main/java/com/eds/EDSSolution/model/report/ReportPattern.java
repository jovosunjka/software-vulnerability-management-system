package com.eds.EDSSolution.model.report;

import com.eds.EDSSolution.model.risk_pattern.CweItem;
import com.eds.EDSSolution.model.risk_pattern.DiagramPattern;

import java.util.List;

public class ReportPattern {

    private static int counter = 0;
    private int id;
    private int numberOfExploits;
    private int numberOfWeaknesses;
    private ReportPatternElement sourceElement;
    private ReportPatternElement destinationElement;
    private ReportPatternExploits exploits;
    private ReportPatternWeaknesses weaknesses;
    private ReportPatternAssets endangeredAssets;


    public ReportPattern() {

    }

    public ReportPattern(DiagramPattern diagramPattern) {
        counter++;
        this.id = counter;
        this.destinationElement = new ReportPatternElement(diagramPattern.getElement());
        this.sourceElement = diagramPattern.getTraceStart() == null ? null : new ReportPatternElement(diagramPattern.getTraceStart());
        this.exploits = new ReportPatternExploits(diagramPattern.getExploitValues());
        this.numberOfExploits = this.exploits.getExploit().size();
        this.weaknesses = new ReportPatternWeaknesses(diagramPattern.getCweValues());
        this.numberOfWeaknesses = this.weaknesses.getWeakness().size();
        this.endangeredAssets = new ReportPatternAssets(diagramPattern.getAssetValues());
    }

    public static int getCounter() {
        return counter;
    }

    public static void setCounter(int counter) {
        ReportPattern.counter = counter;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public int getNumberOfExploits() {
        return numberOfExploits;
    }

    public void setNumberOfExploits(int numberOfExploits) {
        this.numberOfExploits = numberOfExploits;
    }

    public ReportPatternElement getSourceElement() {
        return sourceElement;
    }

    public void setSourceElement(ReportPatternElement sourceElement) {
        this.sourceElement = sourceElement;
    }

    public ReportPatternElement getDestinationElement() {
        return destinationElement;
    }

    public void setDestinationElement(ReportPatternElement destinationElement) {
        this.destinationElement = destinationElement;
    }

    public ReportPatternExploits getExploits() {
        return exploits;
    }

    public void setExploits(ReportPatternExploits exploits) {
        this.exploits = exploits;
    }

    public ReportPatternAssets getEndangeredAssets() {
        return endangeredAssets;
    }

    public void setEndangeredAssets(ReportPatternAssets endangeredAssets) {
        this.endangeredAssets = endangeredAssets;
    }

    public int getNumberOfWeaknesses() {
        return numberOfWeaknesses;
    }

    public void setNumberOfWeaknesses(int numberOfWeaknesses) {
        this.numberOfWeaknesses = numberOfWeaknesses;
    }

    public ReportPatternWeaknesses getWeaknesses() {
        return weaknesses;
    }

    public void setWeaknesses(ReportPatternWeaknesses weaknesses) {
        this.weaknesses = weaknesses;
    }
}
