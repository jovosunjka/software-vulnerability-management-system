package com.eds.EDSSolution.model.report;


import com.eds.EDSSolution.EDS_Library.diagram.ExploitDefinitions;
import com.eds.EDSSolution.model.dto.ElementExploitDTO;

import javax.xml.bind.annotation.XmlRootElement;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;


@XmlRootElement(name = "report")
public class ReportClass {

    private String dateAndTimeOfGeneration;
    private String diagramFileName;
    private ReportPatterns patterns;
    private ReportVulnerabilities vulnerabilities;
    private ReportPatternComplexProcesses complexProcess;
    private ExploitDefinitions exploits;

    public ReportClass() {

    }

    public ReportPatternComplexProcesses getComplexProcess() {
        return complexProcess;
    }

    public void setComplexProcess(ReportPatternComplexProcesses complexProcess) {
        this.complexProcess = complexProcess;
    }

    public ReportClass(List<ReportPattern> patternList, String diagramFileName, List<ElementExploitDTO> complexProcessExploits, ExploitDefinitions exploitDefinitions) {
        this.patterns = new ReportPatterns(patternList);
        this.diagramFileName = diagramFileName;

        SimpleDateFormat sdf = new SimpleDateFormat("dd.MM.yyyy. HH:mm");
        this.dateAndTimeOfGeneration = sdf.format(new Date());

        this.setComplexProcess(new ReportPatternComplexProcesses(complexProcessExploits));
        this.exploits = exploitDefinitions;
    }

    public ReportPatterns getPatterns() {
        return patterns;
    }

    public void setPatterns(ReportPatterns patterns) {
        this.patterns = patterns;
    }

    public String getDateAndTimeOfGeneration() {
        return dateAndTimeOfGeneration;
    }

    public void setDateAndTimeOfGeneration(String dateAndTimeOfGeneration) {
        this.dateAndTimeOfGeneration = dateAndTimeOfGeneration;
    }

    public ExploitDefinitions getExploits() {
        return exploits;
    }

    public void setExploits(ExploitDefinitions exploits) {
        this.exploits = exploits;
    }

    public String getDiagramFileName() {
        return diagramFileName;
    }

    public void setDiagramFileName(String diagramFileName) {
        this.diagramFileName = diagramFileName;
    }

    public ReportVulnerabilities getVulnerabilities() {
        return vulnerabilities;
    }

    public void setVulnerabilities(ReportVulnerabilities vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }
}
